<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GitHub DevFinder</title>
  <!-- Google Fonts import for the Inter font family with different weights -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Font Awesome icons library for various icons used throughout the page -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <!-- Custom CSS file using Flask's url_for function to generate proper paths -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style/style.css') }}">
</head>

<body>
  <!-- Main container card that wraps all content -->
  <div class="card">
    <!-- Header section containing the logo and search form -->
    <header>
      <div class="logo">
        <i class="fa-solid fa-rocket"></i>
        <h1>GitHub DevFinder</h1>
      </div>
      <!-- Search form that submits via POST method to the Flask backend -->
      <form method="POST">
        <input type="text" name="username" placeholder="Enter GitHub username" required>
        <button type="submit"><i class="fa-solid fa-magnifying-glass"></i></button>
      </form>
    </header>

    <!-- Conditional block that only displays if a search has been performed -->
    {% if searched %}
      <!-- Inner conditional that checks if user data was successfully retrieved -->
      {% if user_data %}
        <hr>
        <!-- Profile header row containing avatar and basic user info -->
        <div class="profile-row">
          <!-- User avatar image pulled from GitHub API response -->
          <img src="{{ user_data.avatar_url }}" alt="Avatar" width="120">
          <div class="profile-info">
            <!-- Username displayed from API data -->
            <h2>{{ user_data.login }}</h2>
            <!-- Link to the actual GitHub profile page, opens in new tab -->
            <a href="{{ user_data.html_url }}" class="profile_button" target="_blank">
              <i class="fa-brands fa-github">&nbsp;&nbsp;</i>View on GitHub
            </a>
            
            <!-- Developer insights badges section, only shows if insights data exists -->
            {% if user_insights %}
              <div class="badges-container">
                <!-- Developer type badge based on activity analysis -->
                {% if user_insights.developer_type %}
                  <span class="badge badge-primary">ü¶â {{ user_insights.developer_type }}</span>
                {% endif %}
                <!-- Day pattern badge showing when user is most active -->
                {% if user_insights.day_pattern %}
                  <span class="badge badge-success">üìÖ {{ user_insights.day_pattern }}</span>
                {% endif %}
                <!-- Activity level badge indicating how active the user is -->
                {% if user_insights.activity_level %}
                  <span class="badge badge-info">‚ö° {{ user_insights.activity_level }}</span>
                {% endif %}
                <!-- Special pattern badge for unique activity patterns -->
                {% if user_insights.special_pattern %}
                  <span class="badge badge-warning">‚ú® {{ user_insights.special_pattern }}</span>
                {% endif %}
              </div>
            {% endif %}
          </div>
        </div>

        <!-- User profile details section with icons and fallback values -->
        <!-- Each field uses the 'or' operator to display 'N/A' if the field is empty -->
        <p><strong><i class="fa-solid fa-signature"></i>&nbsp;&nbsp;Name:</strong> {{ user_data.name or "N/A" }}</p>
        <p><strong><i class="fa-solid fa-clipboard"></i>&nbsp;&nbsp;Bio:</strong> {{ user_data.bio or "N/A" }}</p>
        <p><strong><i class="fa-solid fa-building"></i>&nbsp;&nbsp;Company:</strong> {{ user_data.company or "N/A" }}</p>
        <p><strong><i class="fa-solid fa-location-dot"></i>&nbsp;&nbsp;Location:</strong> {{ user_data.location or "N/A" }}</p>
        <!-- These fields always have numeric values so no fallback needed -->
        <p><strong><i class="fa-solid fa-box-open"></i>&nbsp;&nbsp;Public Repos:</strong> {{ user_data.public_repos }}</p>
        <p><strong><i class="fa-solid fa-users"></i>&nbsp;&nbsp;Followers:</strong> {{ user_data.followers }}</p>
        <p><strong><i class="fa-regular fa-handshake"></i>&nbsp;&nbsp;Following:</strong> {{ user_data.following }}</p>

        <hr>

        <!-- Main charts and data visualization grid container -->
        <div class="charts-grid">

          <!-- Recent activity events table section -->
          {% if user_events %}
            <div class="chart">
              <h2 class="chart-title"><i class="fa-solid fa-clock"></i> Recent Activity</h2>
              <!-- Scrollable table container for better mobile experience -->
              <div class="table-container">
                <table class="events-table">
                  <thead>
                    <tr>
                      <th>Type</th>
                      <th>Repository</th>
                      <th>Date</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Loop through first 10 events to avoid overwhelming the display -->
                    {% for event in user_events[:10] %}
                      <tr>
                        <td>
                          <!-- Dynamic event type styling with appropriate icons -->
                          <span class="event-type {{ event.type.lower() }}">
                            <!-- Conditional icon display based on GitHub event type -->
                            {% if event.type == 'PushEvent' %}
                              <i class="fa-solid fa-code-commit"></i> Push
                            {% elif event.type == 'WatchEvent' %}
                              <i class="fa-solid fa-star"></i> Star
                            {% elif event.type == 'CreateEvent' %}
                              <i class="fa-solid fa-plus-circle"></i> Create
                            {% elif event.type == 'IssuesEvent' %}
                              <i class="fa-solid fa-exclamation-circle"></i> Issue
                            {% else %}
                              <!-- Fallback for other event types, removes 'Event' suffix -->
                              <i class="fa-solid fa-circle"></i> {{ event.type.replace('Event', '') }}
                            {% endif %}
                          </span>
                        </td>
                        <!-- Repository name, splits full path and shows only repo name -->
                        <td class="repo-name">{{ event.repo_name.split('/')[-1] }}</td>
                        <!-- Date formatting to show only YYYY-MM-DD part -->
                        <td class="event-date">{{ event.created_at[:10] }}</td>
                      </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            </div>
          {% endif %}

          <!-- Activity patterns and timing analysis section -->
          {% if user_createdat %}
            <div class="chart">
              <h2 class="chart-title"><i class="fa-solid fa-chart-line"></i> Activity Patterns</h2>
              
              <!-- Key statistics about most active times -->
              <div class="time-stats">
                <!-- Find and display the hour with most activity -->
                {% if user_createdat.hours %}
                  {% set most_active_hour = user_createdat.hours.keys()|list|max %}
                  <div class="stat-item">
                    <span class="stat-label">Most Active Hour:</span>
                    <span class="stat-value">{{ most_active_hour }}:00</span>
                  </div>
                {% endif %}
                
                <!-- Display the most active day of the week -->
                {% if user_createdat.days %}
                  {% set most_active_day = user_createdat.days.keys()|list|first %}
                  <div class="stat-item">
                    <span class="stat-label">Most Active Day:</span>
                    <span class="stat-value">{{ most_active_day }}</span>
                  </div>
                {% endif %}
              </div>

              <!-- Visual bar chart showing activity distribution across days -->
              <div class="activity-distribution">
                <h4>Weekly Distribution:</h4>
                {% if user_createdat.days %}
                  <!-- Loop through each day and create a proportional bar -->
                  {% for day, count in user_createdat.days.items() %}
                    <div class="day-bar">
                      <!-- Abbreviated day name for compact display -->
                      <span class="day-name">{{ day[:3] }}</span>
                      <div class="bar-container">
                        <!-- Bar width calculated as percentage of maximum day activity -->
                        <div class="bar" style="width: {{ (count / user_createdat.days.values()|max * 100)|round }}%"></div>
                      </div>
                      <!-- Actual count number for this day -->
                      <span class="day-count">{{ count }}</span>
                    </div>
                  {% endfor %}
                {% endif %}
              </div>
            </div>
          {% endif %}
          
          <!-- Programming languages chart generated by backend -->
          {% if chart_html %}
            <div class="chart">
              <h2 class="chart-title"><i class="fa-solid fa-code"></i> Most Used Languages</h2>
              <!-- Raw HTML chart content from Flask backend, marked as safe -->
              {{ chart_html|safe }}
            </div>
          {% endif %}

          <!-- Comprehensive developer profile insights section -->
          {% if user_insights %}
            <div class="chart">
              <h2 class="chart-title"><i class="fa-solid fa-brain"></i> Developer Profile</h2>
              
              <!-- Grid layout for key developer metrics -->
              <div class="insights-grid">
                <!-- Total events counter with icon -->
                <div class="insight-item">
                  <div class="insight-icon">üìä</div>
                  <div class="insight-content">
                    <span class="insight-label">Total Events:</span>
                    <span class="insight-value">{{ user_insights.total_events }}</span>
                  </div>
                </div>

                <!-- Peak activity hour display -->
                <div class="insight-item">
                  <div class="insight-icon">üïê</div>
                  <div class="insight-content">
                    <span class="insight-label">Peak Hour:</span>
                    <span class="insight-value">{{ user_insights.most_active_hour }}:00</span>
                  </div>
                </div>

                <!-- Most active day of the week -->
                <div class="insight-item">
                  <div class="insight-icon">üìÖ</div>
                  <div class="insight-content">
                    <span class="insight-label">Peak Day:</span>
                    <span class="insight-value">{{ user_insights.most_active_day }}</span>
                  </div>
                </div>

                <!-- Development style based on activity patterns -->
                <div class="insight-item">
                  <div class="insight-icon">üíª</div>
                  <div class="insight-content">
                    <span class="insight-label">Style:</span>
                    <span class="insight-value">{{ user_insights.event_style }}</span>
                  </div>
                </div>
              </div>

              <!-- Percentage breakdowns with visual progress bars -->
              {% if user_insights.percentages %}
                <div class="percentages-section">
                  <h4>Activity Breakdown:</h4>
                  <div class="percentage-bars">
                    <!-- Weekend activity percentage with visual bar -->
                    <div class="percentage-item">
                      <span class="percentage-label">Weekend Activity</span>
                      <div class="percentage-bar">
                        <!-- Bar fill width set dynamically based on percentage -->
                        <div class="percentage-fill" style="width: {{ user_insights.percentages.weekend }}%"></div>
                      </div>
                      <span class="percentage-value">{{ user_insights.percentages.weekend }}%</span>
                    </div>
                    
                    <!-- Push events percentage with different styling -->
                    <div class="percentage-item">
                      <span class="percentage-label">Push Events</span>
                      <div class="percentage-bar">
                        <!-- Special 'push' class for different color scheme -->
                        <div class="percentage-fill push" style="width: {{ user_insights.percentages.push_events }}%"></div>
                      </div>
                      <span class="percentage-value">{{ user_insights.percentages.push_events }}%</span>
                    </div>
                  </div>
                </div>
              {% endif %}
            </div>
          {% endif %}

        </div>
        
      {% else %}
        <!-- Error message displayed when user is not found -->
        <p style="color: red;">User not found.</p>
      {% endif %}
    {% endif %}
  </div>
</body>
</html>
<!-- Thodoris Trifonopoulos dev finder -->